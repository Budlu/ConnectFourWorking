(this["webpackJsonpconn-four-app"]=this["webpackJsonpconn-four-app"]||[]).push([[0],{15:function(t,e,s){"use strict";s.r(e);var i=s(0),a=s(8),n=s(3),r=s(4),o=s(1),c=s(6),h=s(5),l=s(2),u=s.n(l),d=s(9),p=s.n(d),b=function(t){Object(c.a)(s,t);var e=Object(h.a)(s);function s(t){var i;return Object(n.a)(this,s),(i=e.call(this,t)).state={rows:t.rows,columns:t.columns},i}return Object(r.a)(s,[{key:"getColumn",value:function(t){for(var e=[],s=0;s<this.props.board.length;s++)e.push(this.props.board[s][t]);return e}},{key:"renderColumn",value:function(t){var e=this,s=Object(i.jsx)(y,{index:t,total_height:this.props.rows,column:this.getColumn(t),highlighted:this.props.highlighted[t],redFirst:this.props.redFirst,best:this.props.best,analysis:this.props.analysis,lastMove:this.props.lastMove});return Object(i.jsx)("div",{className:"column",children:Object(i.jsx)("button",{onClick:function(){return e.debugClick(t)},children:s})},t)}},{key:"getMoveHeight",value:function(t){for(var e=this.props.board.length-1;e>=0;){if(!this.props.board[e][t])return e;e-=1}return e}},{key:"debugClick",value:function(t){if(this.props.active&&this.props.playerMove){var e=this.getMoveHeight(t);-1!==e&&this.props.updateBoard(e,t)}}},{key:"render",value:function(){for(var t=[],e=0;e<this.state.columns;e++)t.push(this.renderColumn(e));return Object(i.jsx)("div",{className:"game",children:t})}}]),s}(u.a.Component),y=function(t){Object(c.a)(s,t);var e=Object(h.a)(s);function s(t){var i;return Object(n.a)(this,s),(i=e.call(this,t)).state={index:t.index,total_height:t.total_height,tile_height:t.tile_height},i}return Object(r.a)(s,[{key:"renderTile",value:function(t){var e=this.props.column[t],s=["tile"];return 1===e?this.props.redFirst?s.push("red"):s.push("yellow"):-1===e&&(this.props.redFirst?s.push("yellow"):s.push("red")),Object(i.jsx)(v,{i:t,column:this.props.index,class:s.join(" "),highlighted:this.props.highlighted[t]},t)}},{key:"render",value:function(){var t=[];this.props.analysis&&this.props.best===this.props.index&&!this.props.lastMove?t.push(Object(i.jsx)(m,{visible:!0},this.props.total_height)):t.push(Object(i.jsx)(m,{visible:!1},this.props.total_height));for(var e=0;e<this.props.total_height;e++)t.push(this.renderTile(e));return t}}]),s}(u.a.Component);function m(t){var e=["arrow"];return t.visible||e.push("invisible"),Object(i.jsx)("img",{src:"/static/connect/Arrow.png",className:e.join(" "),alt:""})}function v(t){var e=[t.class];return t.highlighted&&e.push("highlighted"),Object(i.jsx)("li",{style:{borderTop:0===t.i?"auto":"none",borderLeft:0===t.column?"auto":"none"},className:e.join(" ")},t.i)}var j=function(t){Object(c.a)(s,t);var e=Object(h.a)(s);function s(t){var i;return Object(n.a)(this,s),(i=e.call(this,t)).playerVersusPlayer=i.playerVersusPlayer.bind(Object(o.a)(i)),i.playerVersusComputer=i.playerVersusComputer.bind(Object(o.a)(i)),i.backPVPPVC=i.backPVPPVC.bind(Object(o.a)(i)),i.whichPlayer=i.whichPlayer.bind(Object(o.a)(i)),i.playerFirstMenu=i.playerFirstMenu.bind(Object(o.a)(i)),i.computerFirstMenu=i.computerFirstMenu.bind(Object(o.a)(i)),i.whichColor=i.whichColor.bind(Object(o.a)(i)),i.redFirstMenu=i.redFirstMenu.bind(Object(o.a)(i)),i.yellowFirstMenu=i.yellowFirstMenu.bind(Object(o.a)(i)),i.startGame=i.startGame.bind(Object(o.a)(i)),i.state={prompt:"Select a mode: ",buttonOneText:"Player v. Player",buttonOneFunction:i.playerVersusPlayer,buttonTwoText:"Player v. Computer",buttonTwoFunction:i.playerVersusComputer,backFunction:function(){},gameStarted:!1},i}return Object(r.a)(s,[{key:"render",value:function(){var t=this;return this.state.gameStarted?this.props.visible&&!this.props.started?Object(i.jsxs)("div",{className:"menu",children:[Object(i.jsx)("button",{onClick:function(){t.restartGame(),g()},children:"Restart Game"}),Object(i.jsx)("br",{}),Object(i.jsx)("button",{onClick:function(){t.props.startAnalysis(),g()},children:"Start Analysis"})]}):Object(i.jsx)("div",{className:"menu",children:Object(i.jsx)("button",{onClick:function(){t.restartGame(),g()},children:"Restart Game"})}):Object(i.jsxs)("div",{className:"menu",children:[Object(i.jsxs)("div",{className:"prompt",children:[this.state.prompt,Object(i.jsx)("br",{})]}),Object(i.jsx)("button",{onClick:function(){t.state.buttonOneFunction(),g()},children:this.state.buttonOneText}),Object(i.jsx)("br",{}),Object(i.jsx)("button",{onClick:function(){t.state.buttonTwoFunction(),g()},children:this.state.buttonTwoText}),Object(i.jsx)("br",{}),Object(i.jsx)("button",{onClick:function(){t.state.backFunction(),g()},children:"Back"}),Object(i.jsx)("br",{})]})}},{key:"whichColor",value:function(t){this.setState({prompt:"Which color goes first: ",buttonOneText:"Red",buttonOneFunction:this.redFirstMenu,buttonTwoText:"Yellow",buttonTwoFunction:this.yellowFirstMenu,backFunction:t})}},{key:"whichPlayer",value:function(){this.setState({prompt:"Who goes first: ",buttonOneText:"Player",buttonOneFunction:this.playerFirstMenu,buttonTwoText:"Computer",buttonTwoFunction:this.computerFirstMenu,backFunction:this.backPVPPVC})}},{key:"backPVPPVC",value:function(){this.setState({prompt:"Select a mode: ",buttonOneText:"Player v. Player",buttonOneFunction:this.playerVersusPlayer,buttonTwoText:"Player v. Computer",buttonTwoFunction:this.playerVersusComputer,backFunction:function(){}})}},{key:"startGame",value:function(){this.props.startGame(),this.setState({gameStarted:!0})}},{key:"playerVersusPlayer",value:function(){this.props.pvpMode(!0),this.whichColor(this.backPVPPVC)}},{key:"playerVersusComputer",value:function(){this.props.pvpMode(!1),this.whichPlayer()}},{key:"playerFirstMenu",value:function(){this.props.playerFirst(!0),this.whichColor(this.whichPlayer)}},{key:"computerFirstMenu",value:function(){this.props.playerFirst(!1),this.whichColor(this.whichPlayer)}},{key:"redFirstMenu",value:function(){this.props.redFirst(!0),this.startGame()}},{key:"yellowFirstMenu",value:function(){this.props.redFirst(!1),this.startGame()}},{key:"restartGame",value:function(){this.props.restartGame(),this.backPVPPVC(),this.setState({gameStarted:!1})}}]),s}(u.a.Component),f=new function(t){this.sound=document.createElement("audio"),this.sound.src=t,this.sound.setAttribute("preload","auto"),this.sound.setAttribute("controls","none"),this.sound.setAttribute("id","sound"),this.sound.style.display="none",document.body.appendChild(this.sound),this.play=function(){this.sound.play()},this.stop=function(){this.sound.pause()}}("/static/connect/click.mp3");function g(){f.sound.load(),f.sound.play().catch((function(t){console.warn("Click sound failed")}))}var O=function(t){Object(c.a)(s,t);var e=Object(h.a)(s);function s(){return Object(n.a)(this,s),e.apply(this,arguments)}return Object(r.a)(s,[{key:"render",value:function(){var t=this;if(this.props.visible){var e=this.props.history.map((function(e,s){var a=["analysis-button"];return s===t.props.index&&a.push("highlighted"),0===s?Object(i.jsx)("li",{children:Object(i.jsx)("button",{onClick:function(){return t.props.jump(s)},className:a.join(" "),children:"Start"})},s):Object(i.jsx)("li",{children:Object(i.jsxs)("button",{onClick:function(){return t.props.jump(s)},className:a.join(" "),children:["Move ",s]})},s)}));return Object(i.jsx)("div",{className:"analysis",children:e})}return Object(i.jsx)("div",{className:"analysis"})}},{key:"startAnalysis",value:function(){this.setState({started:!0})}}]),s}(u.a.Component),k=function(t){Object(c.a)(s,t);var e=Object(h.a)(s);function s(){return Object(n.a)(this,s),e.apply(this,arguments)}return Object(r.a)(s,[{key:"render",value:function(){if(!this.props.analysis)return"";var t=-1;void 0!==this.props.p1Height&&(t=this.props.redFirst?this.props.p1Height:100-this.props.p1Height);var e="";return e=this.props.connected||-1!==t?"eval-box":"blank-box",Object(i.jsx)("div",{className:e,children:Object(i.jsx)("div",{className:"eval-red",style:{height:t+"%"}})})}}]),s}(u.a.Component),x="percent",C=function(t){Object(c.a)(s,t);var e=Object(h.a)(s);function s(t){var i;Object(n.a)(this,s),(i=e.call(this,t)).pvpMode=i.pvpMode.bind(Object(o.a)(i)),i.playerFirst=i.playerFirst.bind(Object(o.a)(i)),i.redFirst=i.redFirst.bind(Object(o.a)(i)),i.startGame=i.startGame.bind(Object(o.a)(i)),i.handleData=i.handleData.bind(Object(o.a)(i)),i.moveFromColumn=i.moveFromColumn.bind(Object(o.a)(i)),i.computerMove=i.computerMove.bind(Object(o.a)(i)),i.updateBoard=i.updateBoard.bind(Object(o.a)(i)),i.updateHistory=i.updateHistory.bind(Object(o.a)(i)),i.updateGame=i.updateGame.bind(Object(o.a)(i)),i.restartGame=i.restartGame.bind(Object(o.a)(i)),i.randomMove=i.randomMove.bind(Object(o.a)(i)),i.jump=i.jump.bind(Object(o.a)(i)),i.startAnalysis=i.startAnalysis.bind(Object(o.a)(i)),i.keyDown=i.keyDown.bind(Object(o.a)(i)),i.toggleDarkMode=i.toggleDarkMode.bind(Object(o.a)(i)),document.onkeydown=i.keyDown;var a=function(t){for(var e=t+"=",s=decodeURIComponent(document.cookie).split(";"),i=0;i<s.length;i++){for(var a=s[i];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(e))return a.substring(e.length,a.length)}return""}("darkMode"),r="";return"true"===a?(a=!0,r="/dark.css"):(a=!1,r="/style.css"),i.state={rows:6,columns:7,gameActive:!1,board:F(6,7),highlighted:F(7,6),emptyHighlight:F(7,6),highlightCopy:F(7,6),maximizingPlayer:!0,pvp:!0,playerFirst:!0,redFirst:!0,gameOver:!1,playerCanMove:!0,status:"Pick your settings",history:[{board:F(6,7)}],analysis:!1,index:0,lastMove:!1,connected:!1,stylePath:r,darkMode:a},i}return Object(r.a)(s,[{key:"pvpMode",value:function(t){this.setState({pvp:t})}},{key:"playerFirst",value:function(t){this.setState({playerFirst:t})}},{key:"redFirst",value:function(t){this.setState({redFirst:t})}},{key:"startGame",value:function(){this.setState({gameActive:!0,playerCanMove:this.state.playerFirst},this.updateGame)}},{key:"updateBoard",value:function(t,e){var s=0;s=this.state.maximizingPlayer?1:-1;var n=JSON.parse(JSON.stringify(this.state.board));n[t][e]=s;var r=this.state.history;r.push({board:n}),this.setState({history:r,index:this.state.index+1});var o=function(t,e,s){var i=t.length,a=t[0].length,n=w(s-3,0,a-4),r=w(s,0,a-4);for(;n<=r;){if([t[e][n],t[e][n+1],t[e][n+2],t[e][n+3]].every((function(t,e,s){return t===s[0]})))return[[e,n],[e,n+1],[e,n+2],[e,n+3]];n+=1}if(e<=i-4){if([t[e][s],t[e+1][s],t[e+2][s],t[e+3][s]].every((function(t,e,s){return t===s[0]})))return[[e,s],[e+1,s],[e+2,s],[e+3,s]]}var o=M(e,s);n=w(o,0,3);var c=M(i-e-1,a-s-1);r=w(3-c,0,3);for(;n>=r;){if([t[e-n][s-n],t[e-n+1][s-n+1],t[e-n+2][s-n+2],t[e-n+3][s-n+3]].every((function(t,e,s){return t===s[0]})))return[[e-n,s-n],[e-n+1,s-n+1],[e-n+2,s-n+2],[e-n+3,s-n+3]];n-=1}o=M(i-e-1,s),c=M(e,a-s-1),n=w(c,0,3),r=w(3-o,0,3);for(;n>=r;){if([t[e-n][s+n],t[e-n+1][s+n-1],t[e-n+2][s+n-2],t[e-n+3][s+n-3]].every((function(t,e,s){return t===s[0]})))return[[e-n,s+n],[e-n+1,s+n-1],[e-n+2,s+n-2],[e-n+3,s+n-3]];n-=1}for(var h=0;h<a;h++)if(!t[0][h])return 0;return 2}(n,t,e);if(2===o)return this.setState({board:n,maximizingPlayer:!this.state.maximizingPlayer,gameActive:!1,gameOver:!0,status:"It's a draw"}),void S();if(0!==o){var c,h=F(this.state.columns,this.state.rows),l=Object(a.a)(o);try{for(l.s();!(c=l.n()).done;){var u=c.value;h[u[1]][u[0]]=1}}catch(y){l.e(y)}finally{l.f()}var d="",p="";P(this.state.maximizingPlayer,this.state.redFirst)?(d="Red",p="red"):(d="Yellow",p="yellow");var b=JSON.parse(JSON.stringify(h));return this.setState({board:n,maximizingPlayer:!this.state.maximizingPlayer,gameActive:!1,gameOver:!0,highlighted:h,highlightCopy:b,status:Object(i.jsxs)("span",{style:{color:p},children:[d," wins!"]})}),void S()}this.state.pvp?this.setState({board:n,maximizingPlayer:!this.state.maximizingPlayer},this.updateGame):this.setState({board:n,maximizingPlayer:!this.state.maximizingPlayer,playerCanMove:!this.state.playerCanMove},this.updateGame),S()}},{key:"updateGame",value:function(){var t=Object(i.jsx)("span",{style:{color:"red"},children:"Red's move"}),e=Object(i.jsx)("span",{style:{color:"yellow"},children:"Yellow's move"});P(this.state.maximizingPlayer,this.state.redFirst)?this.setState({status:t}):this.setState({status:e}),this.state.pvp||this.state.playerCanMove||this.computerMove()}},{key:"restartGame",value:function(){this.setState({gameActive:!1,board:F(6,7),highlighted:F(7,6),highlightCopy:F(7,6),maximizingPlayer:!0,gameOver:!1,playerCanMove:!0,playerFirst:!0,status:"Pick your settings",history:[{board:F(6,7)}],analysis:!1,index:0,lastMove:!1})}},{key:"computerMove",value:function(){var t=this,e={method:"POST",mode:"cors",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify(this.state.board)};fetch(x,e).then((function(t){return t.json()})).then((function(e){t.handleData(e)})).catch((function(e){t.randomMove()}))}},{key:"handleData",value:function(t){if(this.state.gameActive){var e=this.state.history;e[e.length-1].best=t.best,e[e.length-1].percent=t.percent,this.moveFromColumn(t.best),this.setState({history:e})}}},{key:"randomMove",value:function(){if(this.state.gameActive){for(var t=[],e=0;e<this.state.board[0].length;e++)0===this.state.board[0][e]&&t.push(e);var s=Math.floor(Math.random()*t.length);this.moveFromColumn(s)}}},{key:"moveFromColumn",value:function(t){for(var e=this.state.board.length-1;e>=0;){if(!this.state.board[e][t])return void this.updateBoard(e,t);e-=1}this.updateBoard(e,t)}},{key:"jump",value:function(t){t>this.state.index&&S(),t===this.state.history.length-1?this.setState({board:this.state.history[t].board,highlighted:this.state.highlightCopy,index:t,lastMove:!0}):this.setState({board:this.state.history[t].board,highlighted:this.state.emptyHighlight,index:t,lastMove:!1})}},{key:"updateHistory",value:function(t,e){if(this.state.analysis){var s=this.state.history;s[e].percent=t.percent,s[e].best=t.best,this.setState({history:s,connected:!0})}}},{key:"startAnalysis",value:function(){var t=this;this.setState({analysis:!0});for(var e=function(e){if(void 0===t.state.history[e].percent){var s={method:"POST",mode:"cors",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify(t.state.history[e].board)};fetch(x,s).then((function(t){return t.json()})).then((function(s){t.updateHistory(s,e)})).catch((function(e){t.setState({connected:!1})}))}},s=0;s<this.state.history.length;s++)e(s);this.jump(0)}},{key:"keyDown",value:function(t){var e=window.event?window.event:t;"ArrowDown"===e.key||"ArrowRight"===e.key||"s"===e.key||"d"===e.key?(this.state.analysis&&this.state.index<this.state.history.length-1&&this.jump(this.state.index+1),e.preventDefault()):"ArrowUp"!==e.key&&"ArrowLeft"!==e.key&&"w"!==e.key&&"a"!==e.key||(this.state.analysis&&this.state.index>0&&this.jump(this.state.index-1),e.preventDefault())}},{key:"toggleDarkMode",value:function(){var t=!this.state.darkMode;t?this.setState({darkMode:t,stylePath:"/dark.css"}):this.setState({darkMode:t,stylePath:"/style.css"}),function(t,e,s){var i=new Date;i.setTime(i.getTime()+24*s*60*60*1e3);var a="expires="+i.toUTCString();document.cookie=t+"="+e+";"+a+";path=/"}("darkMode",t,3650)}},{key:"render",value:function(){var t=this;return Object(i.jsxs)("div",{className:"container",children:[Object(i.jsx)("link",{rel:"stylesheet",type:"text/css",href:"/static/connect"+this.state.stylePath}),Object(i.jsxs)("div",{className:"header",children:[Object(i.jsx)("h1",{children:"Connect Four"}),Object(i.jsxs)("div",{className:"credits",children:["Matthew Rubino - ",Object(i.jsx)("a",{href:"https://github.com/Budlu/ConnectFour",target:"_blank",rel:"noreferrer",children:"https://github.com/Budlu/ConnectFour"})]})]}),Object(i.jsxs)("div",{className:"content",children:[Object(i.jsxs)("div",{className:"column-1",children:[Object(i.jsx)(j,{pvpMode:this.pvpMode,playerFirst:this.playerFirst,redFirst:this.redFirst,startGame:this.startGame,restartGame:this.restartGame,visible:this.state.gameOver,started:this.state.analysis,startAnalysis:this.startAnalysis}),Object(i.jsx)(O,{visible:this.state.analysis,history:this.state.history,jump:this.jump,index:this.state.index})]}),Object(i.jsxs)("div",{className:"column-2",children:[Object(i.jsx)("h2",{children:this.state.status}),Object(i.jsxs)("div",{className:"game-link",children:[Object(i.jsx)(k,{redFirst:this.state.redFirst,p1Height:this.state.history[this.state.index].percent,analysis:this.state.analysis,connected:this.state.connected}),Object(i.jsx)(b,{rows:6,columns:7,board:this.state.board,highlighted:this.state.highlighted,updateBoard:this.updateBoard,active:this.state.gameActive,redFirst:this.state.redFirst,playerMove:this.state.playerCanMove,analysis:this.state.analysis,best:this.state.history[this.state.index].best,lastMove:this.state.lastMove,connected:this.state.connected})]})]})]}),Object(i.jsx)("button",{className:"dark-mode",onClick:function(){t.toggleDarkMode(),function(){var t=document.getElementsByClassName("click-source")[0];t.load(),t.play().catch((function(t){console.warn(t)}))}()},children:"O"}),Object(i.jsx)("audio",{src:"/static/connect/click.mp3",preload:"auto",controls:"none",id:"sound",style:{display:"none"},className:"click-source"}),Object(i.jsx)("audio",{src:"/static/connect/drop.mp3",preload:"auto",controls:"none",id:"sound",style:{display:"none"},className:"drop-source"})]})}}]),s}(u.a.Component);function F(t,e){for(var s=[],i=0;i<t;i++){for(var a=[],n=0;n<e;n++)a.push(0);s.push(a)}return s}function w(t,e,s){return t>=s?s:t<=e?e:t}function M(t,e){return t<e?t:e}function P(t,e){return e?!!t:!t}function S(){var t=document.getElementsByClassName("drop-source")[0];setTimeout((function(){t.load(),t.play().catch((function(t){console.warn(t)}))}),125)}var N,T=document.getElementsByClassName("tile"),A=Object(a.a)(T);try{for(A.s();!(N=A.n()).done;){N.value.addEventListener("animationend",void S())}}catch(G){A.e(G)}finally{A.f()}p.a.render(Object(i.jsx)(C,{}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.0f52ec73.chunk.js.map